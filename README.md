# çµå…½"ç™½æ³½" (Baize) - Obsidian æ’ä»¶æ¶æ„è®¾è®¡

## 1. æ ¸å¿ƒå®šä½

"ç™½æ³½"åœ¨ä¸­å›½ä¼ ç»Ÿæ–‡åŒ–ä¸­æœ‰é€šæ™“ä¸‡ç‰©çš„ç‰¹è´¨ã€‚æœ¬æ’ä»¶æ—¨åœ¨æˆä¸ºä¸ªäººçŸ¥è¯†åº“ä¸­"æ— æ‰€ä¸çŸ¥"çš„çµå…½ï¼Œé€šè¿‡è¯­ä¹‰æ£€ç´¢å’Œæœ¬åœ°æ™ºèƒ½ï¼Œæ‰“ç ´ä¼ ç»Ÿå…³é”®è¯æœç´¢çš„å±€é™ï¼Œå»ºç«‹ä¸€ä¸ªéšç§ã€æé€Ÿã€æ·±åº¦çš„çŸ¥è¯†åŠ©æ‰‹ã€‚

### ğŸ“¸ UI é¢„è§ˆ

**æ¡Œé¢ç«¯** â€” å³ä¾§é¢æ¿å¸¸é©»å¯¹è¯ / è¯­ä¹‰æœç´¢ / çµæ„Ÿè”æƒ³

![æ¡Œé¢ç«¯ UI åŸå‹](UI%20åŸå‹/desktop.png)

**ç§»åŠ¨ç«¯** â€” åº•éƒ¨æŠ½å±‰ + å•æ‰‹æ“ä½œä¼˜åŒ–

![ç§»åŠ¨ç«¯ UI åŸå‹](UI%20åŸå‹/mobile.png)

---

## 2. æŠ€æœ¯æ ˆ

| å±‚çº§       | æŠ€æœ¯é€‰å‹                                       | èŒè´£                           |
| ---------- | ---------------------------------------------- | ------------------------------ |
| å‘é‡æ•°æ®åº“ | LanceDB (WASM)                                 | æœ¬åœ°é«˜æ€§èƒ½æŒä¹…åŒ–å‘é‡å­˜å‚¨ä¸æ£€ç´¢ |
| å‘é‡åŒ–æ¨¡å‹ | `transformers.js` (ONNX Runtime WASM)          | æœ¬åœ°æ–‡æœ¬å‘é‡åŒ–ï¼Œéšç§ä¸å‡ºæœ¬åœ°   |
| LLM å¤§è„‘   | äº‘ç«¯: DeepSeek / OpenAI API; æœ¬åœ°: Ollama æ¥å£ | RAG æ£€ç´¢å¢å¼ºç”Ÿæˆ               |
| å®¿ä¸»ç¯å¢ƒ   | Obsidian (Electron æ¡Œé¢ / Capacitor ç§»åŠ¨ç«¯)    | æ’ä»¶è¿è¡Œæ—¶                     |
| UI æ¡†æ¶    | Svelte 5                                       | å“åº”å¼è§†å›¾å±‚                   |
| æ„å»ºå·¥å…·   | esbuild                                        | äº§ç‰©æ‰“åŒ…ä¸ WASM èµ„æºå¤„ç†       |

---

## 3. æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 3.1 è¯­ä¹‰æœç´¢ (Semantic Search)
ä½¿ç”¨è‡ªç„¶è¯­è¨€æ„å›¾æœç´¢ï¼Œè€Œéæ­»æ¿çš„å…³é”®è¯åŒ¹é…ã€‚ç”¨æˆ·è¾“å…¥ä¸€æ®µè¯ï¼Œç™½æ³½è¿”å›è¯­ä¹‰æœ€ç›¸å…³çš„ç¬”è®°ç‰‡æ®µã€‚

### 3.2 ç™½æ³½å¯¹è¯å± (Chat View)
ä¾§è¾¹æ å¯¹è¯æ¡†ï¼ŒåŸºäºåº“å†…çŸ¥è¯†å›ç­”é—®é¢˜å¹¶é™„å¸¦å¼•ç”¨æ¥æºã€‚é‡‡ç”¨ RAG æµç¨‹ï¼šæŸ¥è¯¢ â†’ è¯­ä¹‰æ£€ç´¢ä¸Šä¸‹æ–‡ â†’ æ‹¼æ¥ Prompt â†’ æµå¼å›å¤ã€‚

### 3.3 çŸ¥è¯†è”æƒ³ (Insight)
è‡ªåŠ¨æ ¹æ®å½“å‰æ‰“å¼€çš„ç¬”è®°å†…å®¹ï¼Œæ¨èåº“ä¸­è¯­ä¹‰æœ€ç›¸å…³çš„å…¶ä»–ç¬”è®°ç‰‡æ®µï¼Œå®ç°"è¢«åŠ¨å‘ç°"ã€‚

### 3.4 å®æ—¶ç´¢å¼• (Live Indexing)
è‡ªåŠ¨ç›‘å¬ Vault ä¸­çš„æ–‡ä»¶å˜æ›´ï¼ˆ`create`ã€`modify`ã€`delete`ã€`rename`ï¼‰ï¼Œç§’çº§ç»´æŠ¤å‘é‡åº“ï¼Œæ— éœ€æ‰‹åŠ¨è§¦å‘å…¨é‡æ‰«æã€‚

---

## 4. åˆ†å±‚æ¶æ„ï¼ˆLayered Architectureï¼‰

æ•´ä½“é‡‡ç”¨**å››å±‚åˆ†å±‚æ¶æ„ + è·¨åˆ‡é¢æœåŠ¡**ï¼Œè‡ªåº•å‘ä¸ŠèŒè´£å±‚å±‚é€’è¿›ï¼Œæ¯å±‚åªä¾èµ–å…¶ä¸‹å±‚ï¼Œä¸¥ç¦è·³å±‚ä¾èµ–ã€‚

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  UI å±‚ (Presentation)                 â”‚
â”‚           Svelte ç»„ä»¶ Â· å¹³å°é€‚é…è§†å›¾å…¥å£              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 åº”ç”¨å±‚ (Application)                  â”‚
â”‚     ç”¨ä¾‹ç¼–æ’ Â· ç´¢å¼•è°ƒåº¦ Â· RAG ç®¡çº¿ Â· åŒæ­¥æœåŠ¡        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  é¢†åŸŸå±‚ (Domain)                      â”‚
â”‚    åˆ†å—ç­–ç•¥ Â· å‘é‡åŒ–æŠ½è±¡ Â· LLM å®¢æˆ·ç«¯ Â· æ•°æ®æ¨¡å‹     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               åŸºç¡€è®¾æ–½å±‚ (Infrastructure)             â”‚
â”‚     LanceDB é€‚é…å™¨ Â· æ¨¡å‹ç®¡ç† Â· Worker æ±  Â· å¹³å°é€‚é… â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†• è·¨åˆ‡é¢ (Cross-cutting): ç±»å‹ç³»ç»Ÿ Â· äº‹ä»¶æ€»çº¿ Â· æ—¥å¿— Â· é…ç½®ç®¡ç†
```

### 4.1 ä¾èµ–è§„åˆ™
- UI å±‚ â†’ åº”ç”¨å±‚ â†’ é¢†åŸŸå±‚ â†’ åŸºç¡€è®¾æ–½å±‚
- é¢†åŸŸå±‚å®šä¹‰**æ¥å£ (Interface)**ï¼ŒåŸºç¡€è®¾æ–½å±‚æä¾›**å®ç° (Implementation)**ï¼ˆä¾èµ–åè½¬åŸåˆ™ï¼‰
- è·¨åˆ‡é¢æœåŠ¡å¯è¢«ä»»æ„å±‚å¼•ç”¨

---

## 5. é¡¹ç›®ä»£ç ç»“æ„

```text
baize-obsidian-plugin/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                    # æ’ä»¶å…¥å£ï¼šç”Ÿå‘½å‘¨æœŸç®¡ç†ã€æ³¨å†Œå‘½ä»¤/è§†å›¾/äº‹ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ infrastructure/            # â•â•â• åŸºç¡€è®¾æ–½å±‚ â•â•â•
â”‚   â”‚   â”œâ”€â”€ database/              # å‘é‡æ•°æ®åº“å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ lance-adapter.ts   #   LanceDB WASM é€‚é…å™¨ (å®ç° IVectorStore)
â”‚   â”‚   â”‚   â””â”€â”€ schema.ts         #   å‘é‡è¡¨ç»“æ„å£°æ˜
â”‚   â”‚   â”œâ”€â”€ models/                # æ¨¡å‹ä¸èµ„æºç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ model-manager.ts   #   æ¨¡å‹ä¸‹è½½ã€é‡åŒ–é€‰æ‹©ã€ç¼“å­˜è·¯å¾„ã€ç”Ÿå‘½å‘¨æœŸ
â”‚   â”‚   â”‚   â”œâ”€â”€ onnx-embedder.ts   #   transformers.js å°è£… (å®ç° IEmbedder)
â”‚   â”‚   â”‚   â””â”€â”€ llm-clients/       #   å„ LLM æä¾›å•†çš„å…·ä½“å®ç°
â”‚   â”‚   â”‚       â”œâ”€â”€ deepseek.ts    #     DeepSeek API å®¢æˆ·ç«¯
â”‚   â”‚   â”‚       â”œâ”€â”€ openai.ts      #     OpenAI API å®¢æˆ·ç«¯
â”‚   â”‚   â”‚       â””â”€â”€ ollama.ts      #     Ollama æœ¬åœ°å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ workers/               # Web Worker å¹¶è¡Œè®¡ç®—
â”‚   â”‚   â”‚   â”œâ”€â”€ embedding.worker.ts #   ç‹¬ç«‹çº¿ç¨‹ï¼šæ¨¡å‹åŠ è½½ + æ¨ç† (è§£å†³ UI å¡é¡¿)
â”‚   â”‚   â”‚   â””â”€â”€ worker-pool.ts     #   Worker çº¿ç¨‹æ± ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ storage/                # ç»Ÿä¸€å­˜å‚¨
â”‚   â”‚   â”‚   â””â”€â”€ vault-storage.ts   #   å°è£… Obsidian DataAdapter (æ¡Œé¢/ç§»åŠ¨ç«¯ç»Ÿä¸€)
â”‚   â”‚   â””â”€â”€ platform/              # è·¨å¹³å°é€‚é…
â”‚   â”‚       â”œâ”€â”€ platform-detect.ts #   è¿è¡Œæ—¶å¹³å°æ£€æµ‹ (Desktop / Android / iOS)
â”‚   â”‚       â”œâ”€â”€ desktop.ts         #   æ¡Œé¢ç«¯èƒ½åŠ› (æ‹–æ‹½ã€å…¨å±€å¿«æ·é”®)
â”‚   â”‚       â”œâ”€â”€ android.ts         #   Android ç‰¹æœ‰é€»è¾‘ (è¿”å›é”®ã€åå°ä»»åŠ¡ã€åŠŸè€—æ§åˆ¶)
â”‚   â”‚       â””â”€â”€ ios.ts             #   iOS ç‰¹æœ‰é€»è¾‘ (å®‰å…¨åŒºåŸŸã€åå°é™åˆ¶ã€è§¦æ§åé¦ˆ)
â”‚   â”‚
â”‚   â”œâ”€â”€ domain/                    # â•â•â• é¢†åŸŸå±‚ â•â•â•
â”‚   â”‚   â”œâ”€â”€ interfaces/            # æ ¸å¿ƒæŠ½è±¡æ¥å£ (çº¯ç±»å‹ï¼Œæ— å®ç°)
â”‚   â”‚   â”‚   â”œâ”€â”€ vector-store.ts    #   IVectorStore: å‘é‡å­˜å–æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ embedder.ts        #   IEmbedder: æ–‡æœ¬ â†’ å‘é‡æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ llm-provider.ts    #   ILLMProvider: LLM è°ƒç”¨æ¥å£
â”‚   â”‚   â”œâ”€â”€ models/                # é¢†åŸŸæ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ document-chunk.ts  #   æ–‡æ¡£åˆ†å—çš„æ ¸å¿ƒæ•°æ®ç»“æ„
â”‚   â”‚   â”‚   â””â”€â”€ search-result.ts   #   æœç´¢ç»“æœæ•°æ®ç»“æ„
â”‚   â”‚   â””â”€â”€ chunking/              # æ–‡æœ¬åˆ†å—ç­–ç•¥
â”‚   â”‚       â”œâ”€â”€ markdown-chunker.ts #   Markdown æ„ŸçŸ¥çš„åˆ†å—å™¨
â”‚   â”‚       â””â”€â”€ strategies.ts      #   åˆ†å—ç­–ç•¥ (å›ºå®šé•¿åº¦ / æ ‡é¢˜åˆ†å‰² / è¯­ä¹‰åˆ†æ®µ)
â”‚   â”‚
â”‚   â”œâ”€â”€ application/               # â•â•â• åº”ç”¨å±‚ â•â•â•
â”‚   â”‚   â”œâ”€â”€ index-scheduler.ts     #   ç´¢å¼•è°ƒåº¦ä¸­å¿ƒï¼šå…¨é‡æ‰«æ + å¢é‡åŒæ­¥ç¼–æ’
â”‚   â”‚   â”œâ”€â”€ sync-service.ts        #   å®æ—¶æ–‡ä»¶å˜æ›´ç›‘å¬ â†’ å¢é‡ç´¢å¼•
â”‚   â”‚   â”œâ”€â”€ search-service.ts      #   è¯­ä¹‰æœç´¢æœåŠ¡ï¼šæŸ¥è¯¢ç¼–æ’
â”‚   â”‚   â”œâ”€â”€ rag-pipeline.ts        #   RAG ç®¡çº¿ï¼šæ£€ç´¢ â†’ ä¸Šä¸‹æ–‡æ‹¼æ¥ â†’ LLM è°ƒç”¨
â”‚   â”‚   â””â”€â”€ insight-service.ts     #   çŸ¥è¯†è”æƒ³æœåŠ¡ï¼šåŸºäºå½“å‰ç¬”è®°æ¨èç›¸å…³ç‰‡æ®µ
â”‚   â”‚
â”‚   â”œâ”€â”€ ui/                        # â•â•â• UI å±‚ â•â•â•
â”‚   â”‚   â”œâ”€â”€ views/                 # Obsidian ItemView æ³¨å†Œå…¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ sidebar-view.ts    #   æ¡Œé¢ç«¯ï¼šå³ä¾§é¢æ¿è§†å›¾å®¹å™¨
â”‚   â”‚   â”‚   â””â”€â”€ modal-view.ts      #   ç§»åŠ¨ç«¯ï¼šå…¨å±/åŠå± Modal å®¹å™¨
â”‚   â”‚   â”œâ”€â”€ components/            # Svelte å…±äº«ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ SearchBar.svelte   #   è¯­ä¹‰æœç´¢è¾“å…¥æ¡†
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatPanel.svelte   #   å¯¹è¯é¢æ¿ (æ¶ˆæ¯åˆ—è¡¨ + è¾“å…¥)
â”‚   â”‚   â”‚   â”œâ”€â”€ ResultCard.svelte  #   æœç´¢ç»“æœ / è”æƒ³å¡ç‰‡
â”‚   â”‚   â”‚   â”œâ”€â”€ InsightPanel.svelte #  çŸ¥è¯†è”æƒ³é¢æ¿
â”‚   â”‚   â”‚   â””â”€â”€ StatusBar.svelte   #   ç´¢å¼•è¿›åº¦ / æ¨¡å‹çŠ¶æ€æŒ‡ç¤ºå™¨
â”‚   â”‚   â””â”€â”€ layouts/               # å¹³å°å·®å¼‚åŒ–å¸ƒå±€
â”‚   â”‚       â”œâ”€â”€ DesktopLayout.svelte #  æ¡Œé¢å¸ƒå±€ï¼šä¾§è¾¹æ  Tab åˆ‡æ¢
â”‚   â”‚       â””â”€â”€ MobileLayout.svelte  #  ç§»åŠ¨å¸ƒå±€ï¼šåº•éƒ¨æŠ½å±‰ + å•æ‰‹ä¼˜åŒ–
â”‚   â”‚
â”‚   â”œâ”€â”€ shared/                    # â•â•â• è·¨åˆ‡é¢ â•â•â•
â”‚   â”‚   â”œâ”€â”€ types.ts               #   å…¨å±€ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ constants.ts           #   å¸¸é‡ (æ’ä»¶IDã€é»˜è®¤é…ç½®ã€ç¼“å­˜è·¯å¾„)
â”‚   â”‚   â”œâ”€â”€ event-bus.ts           #   å…¨å±€äº‹ä»¶æ€»çº¿ (è§£è€¦å±‚é—´é€šä¿¡)
â”‚   â”‚   â”œâ”€â”€ logger.ts              #   ç»Ÿä¸€æ—¥å¿—æœåŠ¡ (dev/prod çº§åˆ«æ§åˆ¶)
â”‚   â”‚   â””â”€â”€ errors.ts              #   è‡ªå®šä¹‰é”™è¯¯ç±»å‹ä¸é”™è¯¯å¤„ç†ç­–ç•¥
â”‚   â”‚
â”‚   â””â”€â”€ settings/                  # è®¾ç½®ç®¡ç†
â”‚       â”œâ”€â”€ settings-tab.ts        #   Obsidian è®¾ç½®é¢æ¿ UI
â”‚       â””â”€â”€ default-settings.ts    #   é»˜è®¤é…ç½®å€¼ä¸é…ç½®ç±»å‹å®šä¹‰
â”‚
â”œâ”€â”€ styles/                        # CSS æ ·å¼ (æ„å»ºæ—¶åˆå¹¶ä¸º styles.css)
â”‚   â”œâ”€â”€ variables.css              #   å…¨å±€ CSS å˜é‡ (è‰²å½©ã€å­—ä½“ã€é˜´å½±ã€é—´è·)
â”‚   â”œâ”€â”€ base.css                   #   åŸºç¡€é‡ç½®ä¸å…¬å…±æ ·å¼
â”‚   â”œâ”€â”€ components.css             #   ç»„ä»¶æ ·å¼ (æœç´¢æ¡†ã€å¡ç‰‡ã€å¯¹è¯æ°”æ³¡)
â”‚   â”œâ”€â”€ desktop.css                #   æ¡Œé¢ä¸“å± (ä¾§è¾¹é¢æ¿ã€åˆ†å±ã€æ‹–æ‹½åé¦ˆ)
â”‚   â””â”€â”€ mobile.css                 #   ç§»åŠ¨ä¸“å± (åº•éƒ¨æŠ½å±‰ã€å•æ‰‹æ“ä½œã€è§¦æ§çƒ­åŒº)
â”‚
â”œâ”€â”€ build/                         # æ„å»ºè¾“å‡º (main.js, styles.css, manifest.json)
â”œâ”€â”€ manifest.json                  # Obsidian æ’ä»¶æ¸…å•
â”œâ”€â”€ esbuild.config.mjs             # æ„å»ºè„šæœ¬
â”œâ”€â”€ package.json                   # ä¾èµ–ç®¡ç†
â””â”€â”€ tsconfig.json                  # TypeScript é…ç½®
```

---

## 6. ç§»åŠ¨ç«¯é€‚é…ç­–ç•¥ (Android / iOS)

### 6.1 æ¨¡å‹ä¼˜åŒ–
| å¹³å°    | æ¨¡å‹ç²¾åº¦    | å…¸å‹å¤§å°  | å†…å­˜å ç”¨ | å¤‡æ³¨                     |
| ------- | ----------- | --------- | -------- | ------------------------ |
| æ¡Œé¢ç«¯  | FP32 / FP16 | ~90 MB    | ~200 MB  | è¿½æ±‚ç²¾åº¦                 |
| Android | Q4 (4-bit)  | ~25 MB    | ~60 MB   | è®¾å¤‡å†…å­˜å·®å¼‚å¤§ï¼Œéœ€åŠ¨æ€æ£€æµ‹ |
| iOS     | Q4 (4-bit)  | ~25 MB    | ~60 MB   | å†…å­˜å‹åŠ›æ›´ä¸¥æ ¼ï¼Œè¶…é™ä¼šè¢«ç³»ç»Ÿæ€æ­» |

`model-manager.ts` æ ¹æ® `platform-detect.ts` è¿”å›çš„å¹³å°ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç²¾åº¦ã€‚ç§»åŠ¨ç«¯å¼ºåˆ¶ä½¿ç”¨é‡åŒ–æ¨¡å‹ï¼ŒiOS é¢å¤–è®¾ç½®å†…å­˜æ°´ä½ç›‘æ§ï¼Œé€¼è¿‘é˜ˆå€¼æ—¶ä¸»åŠ¨é‡Šæ”¾æ¨¡å‹ç¼“å­˜ã€‚

### 6.2 ç»Ÿä¸€å­˜å‚¨æ–¹æ¡ˆ

**ä¸è‡ªå»ºå­˜å‚¨æŠ½è±¡ï¼Œç›´æ¥ä½¿ç”¨ Obsidian åŸç”Ÿ `DataAdapter`ã€‚**

Obsidian çš„ `app.vault.adapter` å·²ç»åœ¨å†…éƒ¨å®ç°äº†ä¸‰ç«¯ç»Ÿä¸€çš„æ–‡ä»¶ I/Oï¼š
- æ¡Œé¢ç«¯ â†’ Node.js `fs`
- Android â†’ Capacitor Filesystem API â†’ Android åŸç”Ÿæ–‡ä»¶ç³»ç»Ÿ
- iOS â†’ Capacitor Filesystem API â†’ iOS æ²™ç®±æ–‡ä»¶ç³»ç»Ÿ

æ’ä»¶ä¸éœ€è¦å…³å¿ƒåº•å±‚å·®å¼‚ï¼ŒåŒä¸€å¥—ä»£ç åœ¨ä¸‰ä¸ªå¹³å°ä¸Šç›´æ¥è¿è¡Œã€‚

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ä¸Šå±‚æ¶ˆè´¹è€… (lance-adapter / model-manager)  â”‚
â”‚                     â†“                         â”‚
â”‚           vault-storage.ts (è–„å°è£…å±‚)          â”‚
â”‚                     â†“                         â”‚
â”‚       Obsidian DataAdapter (å¹³å°å†…ç½®)          â”‚
â”‚   read() Â· readBinary() Â· writeBinary()       â”‚
â”‚   exists() Â· remove() Â· list()                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Desktop   â”‚  Android          â”‚  iOS            â”‚
â”‚  Node fs   â”‚  åŸç”Ÿæ–‡ä»¶ç³»ç»Ÿ    â”‚  æ²™ç®±æ–‡ä»¶ç³»ç»Ÿ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          Obsidian åœ¨å¯åŠ¨æ—¶å·²å®Œæˆå¹³å°é€‚é…
```

`vault-storage.ts` æ˜¯ä¸€ä¸ª**è–„å°è£…å±‚**ï¼ŒèŒè´£ä»…ä¸ºï¼š
- å°†æ’ä»¶çš„ç›¸å¯¹è·¯å¾„æ‹¼æ¥ä¸ºå®Œæ•´ Vault è·¯å¾„
- ç»Ÿä¸€é”™è¯¯å¤„ç†ä¸æ—¥å¿—
- æä¾›ç±»å‹å®‰å…¨çš„äºŒè¿›åˆ¶è¯»å†™æ–¹æ³•

**å­˜å‚¨è·¯å¾„çº¦å®š**ï¼š
- **å‘é‡æ•°æ®**ï¼š`.obsidian/plugins/baize-obsidian-plugin/data.lance/`
- **æ¨¡å‹ç¼“å­˜**ï¼š`.obsidian/plugins/baize-obsidian-plugin/cache/`

> ä¸ºä»€ä¹ˆä¸ç”¨ IndexedDB æˆ– SQLiteï¼Ÿå› ä¸ºç™½æ³½çš„æŒä¹…åŒ–éœ€æ±‚æ˜¯**æ–‡ä»¶çº§ I/O**ï¼ˆè¯»å†™ `.lance` äºŒè¿›åˆ¶æ–‡ä»¶å’Œæ¨¡å‹æƒé‡ï¼‰ï¼Œä¸æ˜¯å…³ç³»å‹æŸ¥è¯¢ã€‚Obsidian çš„ `DataAdapter` å·²ç»æ˜¯æœ€ä½³ç­”æ¡ˆâ€”â€”é›¶é¢å¤–ä¾èµ–ï¼ŒåŸç”Ÿè·¨å¹³å°ã€‚

### 6.3 åŠŸè€—æ§åˆ¶

| ç­–ç•¥             | Android                                    | iOS                                      |
| ---------------- | ------------------------------------------ | ---------------------------------------- |
| ç´¢å¼•è§¦å‘æ¨¡å¼     | `è‡ªåŠ¨` / `ä»…å……ç”µæ—¶` / `æ‰‹åŠ¨`              | `è‡ªåŠ¨` / `ä»…å……ç”µæ—¶` / `æ‰‹åŠ¨`             |
| åå°æ‰§è¡Œ         | æ”¯æŒåå°ä»»åŠ¡ï¼Œå¯ç”¨ `requestIdleCallback` åˆ†ç‰‡ | iOS åå°ä¸¥æ ¼é™åˆ¶ï¼Œä»…åœ¨å‰å°æ—¶æ‰§è¡Œç´¢å¼•   |
| å†…å­˜æ°´ä½ç›‘æ§     | å¯é€‰ï¼ˆAndroid å†…å­˜å®¹å¿åº¦è¾ƒé«˜ï¼‰             | å¿…é¡»å¯ç”¨ï¼ˆè¶…é™å³è¢«ç³»ç»Ÿæ€æ­»ï¼‰           |
| æ¨¡å‹é‡Šæ”¾ç­–ç•¥     | App è¿›å…¥åå° 30s åé‡Šæ”¾                    | App è¿›å…¥åå°ç«‹å³é‡Šæ”¾                  |

### 6.4 UI å·®å¼‚åŒ–

**æ¡Œé¢ç«¯ (Desktop)**ï¼š
- å³ä¾§é¢æ¿å¸¸é©»å¯¹è¯/æœç´¢/è”æƒ³ä¸‰æ  Tab åˆ‡æ¢
- æ”¯æŒæ‹–æ‹½æœç´¢ç»“æœç‰‡æ®µè‡³ç¼–è¾‘å™¨
- å…¨å±€å¿«æ·é”® `Ctrl/Cmd+Shift+B` å‘¼å‡ºè¯­ä¹‰æœç´¢

**Android**ï¼š
- åº•éƒ¨æŠ½å±‰ (Bottom Sheet) åŠå±/å…¨å±æ»‘å‡º
- å•æ‰‹æ“ä½œä¼˜åŒ–ï¼Œäº¤äº’å…ƒç´ é”å®šåœ¨å±å¹•ä¸‹åŠéƒ¨
- ç³»ç»Ÿè¿”å›é”®å…¼å®¹ï¼šè¿”å›é”®å…³é—­æŠ½å±‰è€Œéé€€å‡ºæ’ä»¶
- å¡ç‰‡å¼æµå¼å¸ƒå±€ï¼Œé’ˆå¯¹å°å±å¹•ä¼˜åŒ–ä¿¡æ¯å¯†åº¦

**iOS**ï¼š
- åº•éƒ¨æŠ½å±‰ (Bottom Sheet) åŠå±/å…¨å±æ»‘å‡º
- å•æ‰‹æ“ä½œä¼˜åŒ–ï¼Œäº¤äº’å…ƒç´ é”å®šåœ¨å±å¹•ä¸‹åŠéƒ¨
- Safe Area é€‚é…ï¼šå°Šé‡åˆ˜æµ·å±ã€çµåŠ¨å²›ç­‰å®‰å…¨åŒºåŸŸï¼Œé¿å…å†…å®¹è¢«é®æŒ¡
- è§¦æ§åé¦ˆï¼šä½¿ç”¨ iOS åŸç”Ÿé£æ ¼çš„æ»‘åŠ¨æƒ¯æ€§ä¸å›å¼¹æ•ˆæœ

---

## 7. æ ¸å¿ƒæ¶æ„ä¼˜åŒ–

### âš¡ 7.1 Web Worker å¹¶è¡ŒåŒ–

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        postMessage         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ä¸»çº¿ç¨‹        â”‚  â”€â”€â”€â”€ æ–‡æœ¬åˆ†å—æ•°æ® â”€â”€â”€â”€â–¶   â”‚  embedding.worker.ts â”‚
â”‚  (UI + è°ƒåº¦)     â”‚                            â”‚  (transformers.js)   â”‚
â”‚                  â”‚  â—€â”€â”€ Float32Array å‘é‡ â”€â”€  â”‚  (ONNX Runtime WASM) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        onmessage           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **é—®é¢˜**ï¼štransformers.js æ¨¡å‹æ¨ç†å±äº CPU å¯†é›†å‹ä»»åŠ¡ï¼Œç›´æ¥è¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¼šå¯¼è‡´ Obsidian ç•Œé¢å¡æ­»ã€‚
- **æ–¹æ¡ˆ**ï¼šæ‰€æœ‰æ¨¡å‹åŠ è½½ä¸æ¨ç†ä»»åŠ¡è¿è¡Œåœ¨ `embedding.worker.ts` ä¸­ã€‚ä¸»çº¿ç¨‹ä»…é€šè¿‡ `postMessage` å‘é€æ–‡æœ¬ï¼Œæ¥æ”¶å‘é‡ç»“æœã€‚
- **çº¿ç¨‹æ± **ï¼š`worker-pool.ts` ç®¡ç†å¤šä¸ª Worker å®ä¾‹ï¼ˆæ¡Œé¢ç«¯ 2-4 ä¸ªï¼Œç§»åŠ¨ç«¯ 1 ä¸ªï¼‰ï¼Œæ”¯æŒä»»åŠ¡æ’é˜Ÿå’Œå¹¶è¡Œå¤„ç†ã€‚
- **ç§»åŠ¨ç«¯æ³¨æ„**ï¼šCapacitor ç¯å¢ƒä¸­ Web Worker æ— æ³•ç›´æ¥è°ƒç”¨ Capacitor æ’ä»¶ APIï¼ˆç¼ºå°‘ `window` å¯¹è±¡ï¼‰ï¼Œå› æ­¤ Worker å†…åªåšçº¯è®¡ç®—ï¼Œæ‰€æœ‰å¹³å° API è°ƒç”¨å›åˆ°ä¸»çº¿ç¨‹ã€‚

### ğŸ“¦ 7.2 åŠ¨æ€æ¨¡å‹åŠ è½½

- **ç­–ç•¥**ï¼šæ’ä»¶å®‰è£…åŒ… (`main.js`) ä¸åŒ…å«æ¨¡å‹æƒé‡æ–‡ä»¶ï¼Œä¿æŒè½»é‡ã€‚
- **é€»è¾‘**ï¼šé¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œ`model-manager.ts` æ ¹æ®å¹³å°ä¸‹è½½åŒ¹é…çš„æ¨¡å‹ç‰ˆæœ¬å¹¶ç¼“å­˜ã€‚
- **ç¦»çº¿å›é€€**ï¼šè‹¥æ— ç½‘ç»œä¸”æ— ç¼“å­˜ï¼Œæç¤ºç”¨æˆ·æ‰‹åŠ¨å¯¼å…¥æ¨¡å‹æ–‡ä»¶ã€‚

### ğŸ”„ 7.3 äº‹ä»¶é©±åŠ¨è§£è€¦

```text
sync-service  â”€â”€â–¶  EventBus.emit('file:changed', payload)
                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼              â–¼              â–¼
   index-scheduler   insight-service   StatusBar (UIæ›´æ–°)
```

å„å±‚é€šè¿‡ `event-bus.ts` é€šä¿¡ï¼Œé¿å…ç›´æ¥å¼•ç”¨äº§ç”Ÿè€¦åˆã€‚ä¾‹å¦‚ï¼š
- `sync-service` æ£€æµ‹æ–‡ä»¶å˜æ›´åå‘å°„äº‹ä»¶ï¼Œä¸ç›´æ¥è°ƒç”¨ç´¢å¼•å™¨ã€‚
- `index-scheduler` ç›‘å¬äº‹ä»¶åè°ƒåº¦ Worker æ‰§è¡Œå‘é‡åŒ–ã€‚
- UI ç»„ä»¶ç›‘å¬äº‹ä»¶æ›´æ–°è¿›åº¦çŠ¶æ€ã€‚

### ğŸ§ª 7.4 æ„å»ºä¼˜åŒ–

- **WASM å¤„ç†**ï¼š`esbuild.config.mjs` ä¸­ `loader: { '.wasm': 'file' }` ç¡®ä¿ WASM æ–‡ä»¶è¢«æ‹·è´è€Œéå†…è”ã€‚
- **CSS åˆå¹¶**ï¼šæ„å»ºæ—¶å°† `styles/` ä¸‹æ‰€æœ‰ CSS åˆå¹¶ä¸ºä¸€ä¸ª `styles.css` è¾“å‡ºã€‚
- **Tree Shaking**ï¼šæ¡Œé¢ç«¯ä¸ç§»åŠ¨ç«¯çš„å¹³å°ç‰¹å®šä»£ç é€šè¿‡è¿è¡Œæ—¶æ£€æµ‹ (`Platform.isMobile`) ç¡®ä¿ä¸ä¼šåŠ è½½ä¸éœ€è¦çš„æ¨¡å—ã€‚

---

## 8. æ•°æ®æµä¸å…³é”®æµç¨‹

### 8.1 ç´¢å¼•æµç¨‹ (Indexing Pipeline)

```text
Vault æ–‡ä»¶å˜æ›´
     â”‚
     â–¼
sync-service (ç›‘å¬ Obsidian äº‹ä»¶)
     â”‚
     â–¼
index-scheduler (åˆ¤æ–­å¢é‡/å…¨é‡ï¼Œåˆ†å—ä»»åŠ¡åˆ†å‘)
     â”‚
     â–¼
markdown-chunker (æ–‡æœ¬ â†’ è¯­ä¹‰åˆ†å—)
     â”‚
     â–¼
worker-pool â†’ embedding.worker (åˆ†å—æ–‡æœ¬ â†’ å‘é‡)
     â”‚
     â–¼
lance-adapter (å‘é‡ + å…ƒæ•°æ® â†’ å†™å…¥ LanceDB)
```

### 8.2 æœç´¢æµç¨‹ (Search Pipeline)

```text
ç”¨æˆ·è¾“å…¥æŸ¥è¯¢
     â”‚
     â–¼
search-service (æŸ¥è¯¢é¢„å¤„ç†)
     â”‚
     â–¼
embedding.worker (æŸ¥è¯¢æ–‡æœ¬ â†’ æŸ¥è¯¢å‘é‡)
     â”‚
     â–¼
lance-adapter (ANN æœ€è¿‘é‚»æœç´¢ â†’ Top-K ç»“æœ)
     â”‚
     â–¼
ResultCard (UI æ¸²æŸ“æœç´¢ç»“æœ + ç‚¹å‡»è·³è½¬)
```

### 8.3 RAG å¯¹è¯æµç¨‹

```text
ç”¨æˆ·æé—®
     â”‚
     â–¼
search-service (è¯­ä¹‰æ£€ç´¢ â†’ Top-K ç›¸å…³ç‰‡æ®µ)
     â”‚
     â–¼
rag-pipeline (æ‹¼æ¥ä¸Šä¸‹æ–‡ Prompt)
     â”‚
     â–¼
llm-provider (è°ƒç”¨ DeepSeek/OpenAI/Ollama â†’ æµå¼å›å¤)
     â”‚
     â–¼
ChatPanel (æµå¼æ¸²æŸ“å›å¤ + å¼•ç”¨æ¥æºé«˜äº®)
```

---

## 9. å®æ–½è·¯çº¿ (Roadmap)

---

### ç¬¬ä¸€é˜¶æ®µï¼šé¡¹ç›®éª¨æ¶ä¸åŸºç¡€è®¾æ–½

**1.1 é¡¹ç›®åˆå§‹åŒ–**
- [x] ä½¿ç”¨ Obsidian å®˜æ–¹æ’ä»¶æ¨¡æ¿åˆå§‹åŒ–é¡¹ç›®ç»“æ„
- [x] é…ç½® `tsconfig.json`ï¼šå¯ç”¨ä¸¥æ ¼æ¨¡å¼ã€ESNext targetã€è·¯å¾„åˆ«å (`@/`)
- [x] é…ç½® `package.json`ï¼šæ·»åŠ  `dev`ã€`build`ã€`lint` è„šæœ¬
- [x] é…ç½® `.gitignore`ï¼šæ’é™¤ `build/`ã€`node_modules/`ã€`cache/`
- [x] ç¼–å†™ `manifest.json`ï¼šæ’ä»¶ IDã€åç§°ã€ç‰ˆæœ¬ã€æœ€ä½ Obsidian ç‰ˆæœ¬è¦æ±‚

**1.2 æ„å»ºç³»ç»Ÿ (`esbuild.config.mjs`)**
- [x] é…ç½® esbuild åŸºç¡€ TypeScript â†’ JS ç¼–è¯‘
- [x] é…ç½® Svelte æ’ä»¶ (`esbuild-svelte`)ï¼šæ”¯æŒ `.svelte` æ–‡ä»¶ç¼–è¯‘
- [x] é…ç½® WASM loaderï¼š`{ '.wasm': 'file' }` ç¡®ä¿ WASM æ–‡ä»¶æ‹·è´è€Œéå†…è”
- [x] é…ç½® CSS åˆå¹¶ï¼š`styles/` ä¸‹æ‰€æœ‰ CSS åˆå¹¶ä¸º `build/styles.css`
- [x] é…ç½® Web Worker æ‰“åŒ…ï¼šWorker æ–‡ä»¶ç‹¬ç«‹æ‰“åŒ…ä¸ºå•ç‹¬ JS
- [x] é…ç½® `watch` æ¨¡å¼ï¼šå¼€å‘æ—¶è‡ªåŠ¨é‡ç¼–è¯‘
- [x] é…ç½®è¾“å‡ºåˆ° `build/` ç›®å½•ï¼š`main.js` + `styles.css` + `manifest.json`

**1.3 æ’ä»¶å…¥å£ (`main.ts`)**
- [x] ç»§æ‰¿ `Plugin` ç±»ï¼Œå®ç° `onload()` / `onunload()` ç”Ÿå‘½å‘¨æœŸ
- [x] æ³¨å†Œæ’ä»¶è®¾ç½®é¢æ¿ (`addSettingTab`)
- [x] æ³¨å†Œä¾§è¾¹æ è§†å›¾ (`registerView`)
- [x] æ³¨å†Œå‘½ä»¤ï¼šå‘¼å‡ºè¯­ä¹‰æœç´¢ (`addCommand`)
- [x] æ³¨å†Œ Ribbon å›¾æ ‡æŒ‰é’®
- [x] åˆå§‹åŒ–äº‹ä»¶æ€»çº¿ (`event-bus.ts`)
- [x] åˆå§‹åŒ–æ—¥å¿—æœåŠ¡ (`logger.ts`)
- [x] æ ¹æ®å¹³å°æ£€æµ‹ç»“æœåˆå§‹åŒ–å¹³å°é€‚é…æ¨¡å—
- [x] å¯åŠ¨ç´¢å¼•è°ƒåº¦å™¨ (`index-scheduler.ts`)
- [x] `onunload()` ä¸­é‡Šæ”¾ Worker çº¿ç¨‹æ± ã€å…³é—­ LanceDB è¿æ¥

**1.4 è·¨åˆ‡é¢æœåŠ¡ (`shared/`)**
- [x] `types.ts`ï¼šå®šä¹‰å…¨å±€ç±»å‹ï¼ˆ`PluginSettings`ã€`PlatformType`ã€`IndexStatus`ï¼‰
- [x] `constants.ts`ï¼šæ’ä»¶ IDã€ç¼“å­˜è·¯å¾„ã€é»˜è®¤è®¾ç½®å€¼ã€æ”¯æŒçš„æ¨¡å‹åˆ—è¡¨
- [x] `event-bus.ts`ï¼šå®ç°ç®€æ˜“ EventEmitterï¼ˆ`on`ã€`off`ã€`emit`ã€`once`ï¼‰
- [x] `event-bus.ts`ï¼šå®šä¹‰äº‹ä»¶ç±»å‹æšä¸¾ï¼ˆ`file:changed`ã€`index:progress`ã€`model:ready` ç­‰ï¼‰
- [x] `logger.ts`ï¼šåˆ†çº§æ—¥å¿—ï¼ˆ`debug`ã€`info`ã€`warn`ã€`error`ï¼‰ï¼Œç”Ÿäº§ç¯å¢ƒå…³é—­ debug
- [x] `errors.ts`ï¼šè‡ªå®šä¹‰é”™è¯¯ç±»ï¼ˆ`ModelLoadError`ã€`IndexError`ã€`StorageError`ã€`LLMError`ï¼‰

**1.5 å¹³å°æ£€æµ‹ä¸é€‚é… (`infrastructure/platform/`)**
- [x] `platform-detect.ts`ï¼šé€šè¿‡ `Platform.isMobile`ã€`Platform.isIosApp`ã€`Platform.isAndroidApp` æ£€æµ‹å¹³å°
- [x] `platform-detect.ts`ï¼šå¯¼å‡º `getPlatform(): 'desktop' | 'android' | 'ios'` å‡½æ•°
- [x] `desktop.ts`ï¼šæ³¨å†Œå…¨å±€å¿«æ·é”® `Ctrl/Cmd+Shift+B` å‘¼å‡ºè¯­ä¹‰æœç´¢
- [x] `desktop.ts`ï¼šå®ç°æ‹–æ‹½æ”¯æŒï¼ˆæœç´¢ç»“æœ â†’ ç¼–è¾‘å™¨ï¼‰
- [x] `android.ts`ï¼šæ³¨å†Œç³»ç»Ÿè¿”å›é”®å¤„ç†ï¼ˆå…³é—­æŠ½å±‰è€Œéé€€å‡ºæ’ä»¶ï¼‰
- [x] `android.ts`ï¼šå®ç°åå°ä»»åŠ¡åˆ†ç‰‡é€»è¾‘ (`requestIdleCallback`)
- [x] `ios.ts`ï¼šSafe Area CSS å˜é‡æ³¨å…¥
- [x] `ios.ts`ï¼šApp è¿›å…¥åå°æ—¶ç«‹å³é‡Šæ”¾æ¨¡å‹ç¼“å­˜

**1.6 ç»Ÿä¸€å­˜å‚¨ (`infrastructure/storage/`)**
- [x] `vault-storage.ts`ï¼šå°è£… `app.vault.adapter`ï¼Œæä¾› `readBinary()` / `writeBinary()`
- [x] `vault-storage.ts`ï¼šå®ç°æ’ä»¶ç›¸å¯¹è·¯å¾„ â†’ å®Œæ•´ Vault è·¯å¾„çš„æ‹¼æ¥
- [x] `vault-storage.ts`ï¼šå®ç° `ensureDir()` è‡ªåŠ¨åˆ›å»ºç¼ºå¤±ç›®å½•
- [x] `vault-storage.ts`ï¼šç»Ÿä¸€é”™è¯¯å¤„ç†ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨ã€æƒé™ä¸è¶³ã€ç£ç›˜ç©ºé—´ä¸è¶³ï¼‰
- [x] éªŒè¯å­˜å‚¨åœ¨ Desktop / Android / iOS ä¸‰ç«¯çš„è¯»å†™ä¸€è‡´æ€§

---

### ç¬¬äºŒé˜¶æ®µï¼šå‘é‡æ•°æ®åº“ä¸ç´¢å¼•å¼•æ“

**2.1 LanceDB é›†æˆ (`infrastructure/database/`)**
- [x] `schema.ts`ï¼šå®šä¹‰å‘é‡è¡¨ç»“æ„ï¼ˆ`id`ã€`file_path`ã€`chunk_index`ã€`text`ã€`vector`ã€`metadata`ã€`updated_at`ï¼‰
- [x] `lance-adapter.ts`ï¼šå®ç° `IVectorStore` æ¥å£
- [x] `lance-adapter.ts` â†’ `init()`ï¼šåˆå§‹åŒ– LanceDB WASM å®ä¾‹ï¼Œæ‰“å¼€/åˆ›å»ºæ•°æ®åº“
- [x] `lance-adapter.ts` â†’ `upsert()`ï¼šæ’å…¥æˆ–æ›´æ–°å‘é‡è®°å½•ï¼ˆæŒ‰ `file_path + chunk_index` å»é‡ï¼‰
- [x] `lance-adapter.ts` â†’ `delete()`ï¼šæŒ‰ `file_path` åˆ é™¤è¯¥æ–‡ä»¶çš„æ‰€æœ‰å‘é‡è®°å½•
- [x] `lance-adapter.ts` â†’ `search()`ï¼šANN è¿‘ä¼¼æœ€è¿‘é‚»æŸ¥è¯¢ï¼Œè¿”å› Top-K ç»“æœ
- [x] `lance-adapter.ts` â†’ `getStats()`ï¼šè¿”å›ç´¢å¼•ç»Ÿè®¡ä¿¡æ¯ï¼ˆæ€»è®°å½•æ•°ã€æ€»æ–‡ä»¶æ•°ã€æ•°æ®åº“å¤§å°ï¼‰
- [x] `lance-adapter.ts` â†’ `close()`ï¼šå®‰å…¨å…³é—­æ•°æ®åº“è¿æ¥
- [x] éªŒè¯ LanceDB WASM åœ¨ Desktop / Android / iOS ä¸‰ç«¯èƒ½æ­£å¸¸åˆå§‹åŒ–ä¸è¯»å†™

**2.2 é¢†åŸŸæ¥å£ (`domain/interfaces/`)**
- [x] `vector-store.ts`ï¼šå®šä¹‰ `IVectorStore` æ¥å£ï¼ˆ`init`ã€`upsert`ã€`delete`ã€`search`ã€`getStats`ã€`close`ï¼‰
- [x] `embedder.ts`ï¼šå®šä¹‰ `IEmbedder` æ¥å£ï¼ˆ`loadModel`ã€`embed(text): Promise<Float32Array>`ã€`embedBatch`ã€`unloadModel`ï¼‰
- [x] `llm-provider.ts`ï¼šå®šä¹‰ `ILLMProvider` æ¥å£ï¼ˆ`chat`ã€`chatStream`ã€`getModels`ã€`testConnection`ï¼‰

**2.3 é¢†åŸŸæ•°æ®æ¨¡å‹ (`domain/models/`)**
- [x] `baize-file.ts`ï¼šå®šä¹‰æ–‡ä»¶èšåˆæ ¹ï¼ŒåŒ…å«æ–‡ä»¶å…ƒæ•°æ®ã€ç´¢å¼•çŠ¶æ€ç®¡ç†åŠåˆ†å—é›†åˆ
- [x] `baize-chunk.ts`ï¼šå®šä¹‰åˆ†å—æ¨¡å‹ï¼ŒåŒ…å«æ–‡æœ¬å†…å®¹ã€ä½ç½®ä¿¡æ¯ï¼ˆè¡Œå·/åç§»é‡ï¼‰åŠå…ƒæ•°æ®å¼•ç”¨

**2.4 æ–‡æœ¬åˆ†å— (`domain/chunking/`)**
- [x] `strategies.ts`ï¼šå®šä¹‰åˆ†å—ç­–ç•¥æšä¸¾ï¼ˆ`FIXED_LENGTH`ã€`HEADING_SPLIT`ã€`HYBRID`ï¼‰
- [x] `markdown-chunker.ts`ï¼šå®ç° Markdown æ ‡é¢˜çº§åˆ«æ„ŸçŸ¥åˆ†å—ï¼ˆæŒ‰ `#`ã€`##`ã€`###` åˆ‡åˆ†ï¼‰
- [x] `markdown-chunker.ts`ï¼šå¤„ç†ä»£ç å—ä¸è¢«æ‹†åˆ†ï¼ˆæ£€æµ‹ ``` è¾¹ç•Œï¼‰
- [x] `markdown-chunker.ts`ï¼šå®ç°å›ºå®šé•¿åº¦ä¸æ··åˆåˆ†å—ï¼ˆåœ¨å¥å­/æ¢è¡Œè¾¹ç•Œå¤„ä¼˜åŒ–åˆ‡åˆ†ï¼‰
- [x] `markdown-chunker.ts`ï¼šå®ç°å—å¤§å°é™åˆ¶ä¸é‡å åº¦ (Overlap 15%)
- [x] `markdown-chunker.ts`ï¼šä¿ç•™åˆ†å—å…ƒæ•°æ®ï¼ˆæ ‡é¢˜è·¯å¾„ã€èµ·æ­¢è¡Œå·ã€å­—ç¬¦åç§»é‡ï¼‰
- [x] `markdown-chunker.ts`ï¼šè‡ªåŠ¨å¿½ç•¥ YAML frontmatter åŒºåŸŸ
- [x] å®ç°ä¸­æ–‡åˆ†å—ä¼˜åŒ–ï¼ˆæ”¯æŒ ã€‚ï¼ï¼Ÿ ç­‰ä¸­æ–‡æ ‡ç‚¹ä½œä¸ºæ–­å¥ä¾æ®ï¼‰

**2.5 Web Worker é€šä¿¡ (`infrastructure/workers/`)**
- [x] `embedding.worker.ts`ï¼šWorker å†…éƒ¨åˆå§‹åŒ– `transformers.js` pipeline
- [x] `embedding.worker.ts`ï¼šç›‘å¬ `postMessage` æ¥æ”¶æ–‡æœ¬åˆ†å—æ•°æ®
- [x] `embedding.worker.ts`ï¼šæ‰§è¡Œæ¨¡å‹æ¨ç†ï¼Œé€šè¿‡ `postMessage` è¿”å› `Float32Array` å‘é‡
- [x] `embedding.worker.ts`ï¼šæ”¯æŒæ‰¹é‡æ¨ç†ï¼ˆä¸€æ¬¡æ¥æ”¶å¤šä¸ªæ–‡æœ¬ï¼Œæ‰¹é‡è¿”å›å‘é‡ï¼‰
- [x] `embedding.worker.ts`ï¼šå®ç°æ¨¡å‹åŠ è½½è¿›åº¦å›æŠ¥ï¼ˆ`model:loading` äº‹ä»¶ + ç™¾åˆ†æ¯”ï¼‰
- [x] `embedding.worker.ts`ï¼šå®ç° Worker å†…é”™è¯¯æ•è·ä¸å›ä¼ 
- [x] `worker-pool.ts`ï¼šå®ç°çº¿ç¨‹æ± ç®¡ç†å™¨ï¼ˆæ¡Œé¢ç«¯ 2-4 Workerï¼Œç§»åŠ¨ç«¯ 1 Workerï¼‰
- [x] `worker-pool.ts`ï¼šå®ç°ä»»åŠ¡é˜Ÿåˆ—ï¼ˆFIFOï¼Œå¾…å¤„ç†ä»»åŠ¡æ’é˜Ÿï¼‰
- [x] `worker-pool.ts`ï¼šå®ç° `submit(task): Promise<result>` æäº¤ä»»åŠ¡æ¥å£
- [x] `worker-pool.ts`ï¼šå®ç°ç©ºé—² Worker è‡ªåŠ¨åˆ†é…ä¸å›æ”¶
- [x] `worker-pool.ts`ï¼šå®ç° `terminate()` å®‰å…¨é”€æ¯æ‰€æœ‰ Worker

**2.6 æ¨¡å‹ç®¡ç† (`infrastructure/models/`)**
- [x] `model-manager.ts`ï¼šå®šä¹‰æ¨¡å‹å…ƒæ•°æ®ä¸æè¿°ï¼Œæ”¯æŒæ¨¡å‹åˆ—è¡¨è·å–
- [x] `model-manager.ts`ï¼šå®ç°å¹³å°æ•æ„Ÿçš„æ¨¡å‹æ¨èé€»è¾‘ï¼ˆMobile ä¼˜å…ˆé‡åŒ–æ¨¡å‹ï¼‰
- [x] `model-manager.ts`ï¼šå®ç° `isCached()` æ£€æŸ¥æœ¬åœ°æ¨¡å‹æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨
- [x] `model-manager.ts`ï¼šä» HuggingFace CDN ä¸‹è½½æ¨¡å‹æƒé‡ï¼ˆå¸¦è¿›åº¦å›è°ƒä¸é‡è¯•ï¼‰
- [x] `model-manager.ts`ï¼šä¸‹è½½å¤±è´¥é‡è¯•æœºåˆ¶ï¼ˆæœ€å¤š 3 æ¬¡ï¼ŒæŒ‡æ•°é€€é¿ï¼‰
- [x] `model-manager.ts`ï¼šæ”¯æŒç”¨æˆ·æ‰‹åŠ¨å¯¼å…¥æ¨¡å‹æ–‡ä»¶ï¼ˆç¦»çº¿åœºæ™¯ï¼‰
- [x] `model-manager.ts`ï¼šæ¨¡å‹ç¼“å­˜è·¯å¾„ç®¡ç†ï¼ˆ`.obsidian/plugins/baize-obsidian-plugin/models/`ï¼‰
- [x] `model-manager.ts`ï¼šå®ç° `getModelPath()` è¿”å›å½“å‰è¿è¡Œæ‰€éœ€çš„çœŸå®è·¯å¾„
- [x] `model-manager.ts`ï¼šå®ç° `clearCache()` è°ƒç”¨ Storage å½»åº•æ¸…ç†ç¼“å­˜
- [x] `onnx-embedder.ts`ï¼šåŸºäº Web Worker çº¿ç¨‹æ± å°è£… `transformers.js`
- [x] `onnx-embedder.ts`ï¼šå®ç° `IEmbedder` é¢†åŸŸæ¥å£
- [x] `onnx-embedder.ts`ï¼šå®ç°å‘é‡å½’ä¸€åŒ–ï¼ˆL2 normï¼Œå·²åœ¨ Worker ä¸­é›†æˆï¼‰

**2.7 ç´¢å¼•è°ƒåº¦ (`application/`)**
- [x] `sync-service.ts`ï¼šæ³¨å†Œ Obsidian Vault äº‹ä»¶ç›‘å¬ï¼ˆ`create`ã€`modify`ã€`delete`ã€`rename`ï¼‰
- [x] `sync-service.ts`ï¼šæ–‡ä»¶å˜æ›´é˜²æŠ–ï¼ˆ500ms å†…å¤šæ¬¡ä¿®æ”¹åˆå¹¶ä¸ºä¸€æ¬¡ç´¢å¼•ä»»åŠ¡ï¼‰
- [x] `sync-service.ts`ï¼šè¿‡æ»¤é Markdown æ–‡ä»¶ï¼ˆå¿½ç•¥å›¾ç‰‡ã€PDFã€é™„ä»¶ç­‰ï¼‰
- [x] `sync-service.ts`ï¼šè¿‡æ»¤ç”¨æˆ·æ’é™¤çš„ç›®å½•/æ–‡ä»¶ï¼ˆåŸºäºè®¾ç½®çš„ `excludePaths`ï¼‰
- [x] `sync-service.ts`ï¼šé€šè¿‡äº‹ä»¶æ€»çº¿å‘å°„ `file:changed` äº‹ä»¶
- [x] `index-scheduler.ts`ï¼šç›‘å¬ `file:changed` äº‹ä»¶ï¼Œè°ƒåº¦å¢é‡ç´¢å¼•ä»»åŠ¡
- [x] `index-scheduler.ts`ï¼šå®ç°å…¨é‡æ‰«æé€»è¾‘ï¼ˆé¦–æ¬¡å¯åŠ¨æˆ–ç”¨æˆ·æ‰‹åŠ¨è§¦å‘æ—¶ï¼‰
- [x] `index-scheduler.ts`ï¼šå…¨é‡æ‰«æè¿›åº¦é€šçŸ¥ï¼ˆ`index:progress` äº‹ä»¶ + å·²å¤„ç†/æ€»æ•°ï¼‰
- [x] `index-scheduler.ts`ï¼šå®ç°å¢é‡ç´¢å¼•é€»è¾‘ï¼ˆä»…å¤„ç†å˜æ›´çš„æ–‡ä»¶ï¼‰
- [x] `index-scheduler.ts`ï¼šå¹¶å‘æ§åˆ¶ï¼ˆé€šè¿‡ Worker Pool é˜Ÿåˆ—å®ç°ï¼‰
- [x] `index-scheduler.ts`ï¼šç§»åŠ¨ç«¯åŠŸè€—æ¨¡å¼æ„ŸçŸ¥ï¼ˆåˆæ­¥é€šè¿‡ isMobile ç­–ç•¥å®ç°ï¼‰
- [x] `index-scheduler.ts`ï¼šç´¢å¼•å®Œæˆåå‘å°„ `index:complete` äº‹ä»¶

---

### ç¬¬ä¸‰é˜¶æ®µï¼šæœç´¢ã€RAG ä¸çŸ¥è¯†è”æƒ³

**3.1 è¯­ä¹‰æœç´¢æœåŠ¡ (`application/search-service.ts`)**
- [x] æ¥æ”¶ç”¨æˆ·æŸ¥è¯¢æ–‡æœ¬
- [x] è°ƒç”¨ Worker Pool å°†æŸ¥è¯¢æ–‡æœ¬å‘é‡åŒ–
- [x] è°ƒç”¨ `lance-adapter.search()` æ‰§è¡Œ Top-K ANN æœç´¢
- [x] å¯¹æœç´¢ç»“æœæŒ‰ç›¸ä¼¼åº¦åˆ†æ•°æ’åº
- [x] è¿‡æ»¤ä½äºé˜ˆå€¼ï¼ˆå¦‚ < 0.3ï¼‰çš„ç»“æœ
- [x] å¯¹ç»“æœæ–‡æœ¬è¿›è¡Œå…³é”®è¯é«˜äº®å¤„ç†ï¼ˆè¾…åŠ© UI æ˜¾ç¤ºï¼‰
- [x] è¿”å› `SearchResult[]` é¢†åŸŸå¯¹è±¡ç»™ UI å±‚

**3.2 RAG å¯¹è¯ç®¡çº¿ (`application/rag-pipeline.ts`)**
- [x] æ¥æ”¶ç”¨æˆ·æé—®
- [x] è°ƒç”¨ `search-service` æ£€ç´¢ Top-K ç›¸å…³ç‰‡æ®µ
- [x] æ‹¼æ¥ç³»ç»Ÿ Promptï¼ˆè§’è‰²å®šä¹‰ + å›ç­”è§„åˆ™ + å¼•ç”¨æ ¼å¼è¦æ±‚ï¼‰
- [x] æ‹¼æ¥ä¸Šä¸‹æ–‡ Promptï¼ˆå°†æ£€ç´¢åˆ°çš„ç‰‡æ®µæŒ‰æ ¼å¼æ³¨å…¥ï¼‰
- [x] æ‹¼æ¥ç”¨æˆ· Promptï¼ˆç”¨æˆ·åŸå§‹æé—®ï¼‰
- [x] è°ƒç”¨ `ILLMProvider.chatStream()` è·å–æµå¼å›å¤
- [x] è§£æå›å¤ä¸­çš„å¼•ç”¨æ ‡è®°æ€è·¯ï¼ˆé€šè¿‡ Prompt å¼ºåˆ¶è¾“å‡º [^index] æ ¼å¼ï¼‰
- [x] å°†æµå¼ token æ¨é€ç»™ UI å±‚å®æ—¶æ¸²æŸ“ï¼ˆé€šè¿‡ onChunk å›è°ƒï¼‰
- [x] å®ç°å¯¹è¯å†å²ç®¡ç†ï¼ˆæœ€è¿‘ N è½®å¯¹è¯ä½œä¸ºä¸Šä¸‹æ–‡çª—å£ï¼‰
- [x] å®ç° Token è®¡æ•°å™¨ï¼ˆç®€æ˜“å­—ç¬¦å¯å‘å¼è®¡æ•°å™¨ï¼Œé˜²æ­¢è¶…å‡ºçª—å£ï¼‰

**3.3 LLM å®¢æˆ·ç«¯ (`infrastructure/models/llm-clients/`)**
- [x] `deepseek.ts`ï¼šå®ç° `ILLMProvider` æ¥å£ï¼Œæ¥å…¥ DeepSeek API
- [x] `deepseek.ts`ï¼šæ”¯æŒæµå¼å“åº” (SSE)
- [x] `openai.ts`ï¼šå®ç° `ILLMProvider` æ¥å£ï¼Œæ¥å…¥ OpenAI API
- [x] `openai.ts`ï¼šæ”¯æŒæµå¼å“åº” (SSE)
- [x] `openai.ts`ï¼šå…¼å®¹ OpenAI æ ¼å¼çš„ç¬¬ä¸‰æ–¹ APIï¼ˆè‡ªå®šä¹‰ Base URLï¼‰
- [x] `ollama.ts`ï¼šå®ç° `ILLMProvider` æ¥å£ï¼Œæ¥å…¥æœ¬åœ° Ollama
- [x] `ollama.ts`ï¼šæ”¯æŒæµå¼å“åº”
- [x] `ollama.ts`ï¼šè‡ªåŠ¨æ£€æµ‹æœ¬åœ° Ollama æœåŠ¡æ˜¯å¦å¯ç”¨
- [x] æ‰€æœ‰å®¢æˆ·ç«¯å®ç° `testConnection()` è¿æ¥æµ‹è¯•æ–¹æ³•
- [x] æ‰€æœ‰å®¢æˆ·ç«¯å®ç°è¯·æ±‚è¶…æ—¶å¤„ç†ï¼ˆé»˜è®¤ 30sï¼‰
- [x] æ‰€æœ‰å®¢æˆ·ç«¯å®ç°é”™è¯¯é‡è¯•ï¼ˆç½‘ç»œé”™è¯¯é‡è¯• 2 æ¬¡ï¼‰

**3.4 çŸ¥è¯†è”æƒ³æœåŠ¡ (`application/insight-service.ts`)**
- [x] ç›‘å¬ Obsidian æ´»åŠ¨ç¬”è®°åˆ‡æ¢äº‹ä»¶ (`active-leaf-change`)
- [x] è·å–å½“å‰ç¬”è®°å…¨æ–‡å†…å®¹
- [x] å¯¹å½“å‰ç¬”è®°å†…å®¹è¿›è¡Œåˆ†å—å¹¶é€šè¿‡ `SearchService.searchByVector` è·å–è¯­ä¹‰ç‰¹å¾
- [x] è°ƒç”¨ `lance-adapter.search()` æœç´¢æœ€ç›¸å…³çš„å…¶å®ƒç¬”è®°ç‰‡æ®µï¼ˆæ’é™¤å½“å‰ç¬”è®°è‡ªèº«ï¼‰
- [x] é˜²æŠ–å¤„ç†ï¼ˆç”¨æˆ·å¿«é€Ÿåˆ‡æ¢ç¬”è®°æ—¶ï¼Œå»¶è¿Ÿ 800ms æ‰§è¡Œè”æƒ³ä»»åŠ¡ï¼‰
- [x] ç¼“å­˜æœ€è¿‘ N ç¯‡ç¬”è®°çš„è”æƒ³ç»“æœï¼Œé‡‡ç”¨ LRU ç­–ç•¥
- [x] é€šè¿‡äº‹ä»¶æ€»çº¿æ¨é€ `insight:updated` äº‹ä»¶ç»™ UI å±‚

---

### ç¬¬å››é˜¶æ®µï¼šUI è§†å›¾ä¸äº¤äº’

**4.1 æ¡Œé¢ç«¯è§†å›¾ (`ui/views/sidebar-view.ts`)**
- [x] ç»§æ‰¿ `ItemView`ï¼Œæ³¨å†Œè§†å›¾ç±»å‹ `baize-sidebar`
- [x] å®ç° `onOpen()`ï¼šæŒ‚è½½ Svelte `DesktopLayout` ç»„ä»¶
- [x] å®ç° `onClose()`ï¼šé”€æ¯ Svelte ç»„ä»¶å®ä¾‹
- [x] å®ç° `getViewType()` / `getDisplayText()` / `getIcon()`

**4.2 ç§»åŠ¨ç«¯è§†å›¾ (`ui/views/modal-view.ts`)**
- [x] ç»§æ‰¿ `Modal`ï¼Œå®ç°å…¨å±/åŠå±å¼¹å‡º
- [x] å®ç° `onOpen()`ï¼šæŒ‚è½½ Svelte `MobileLayout` ç»„ä»¶
- [x] å®ç° `onClose()`ï¼šé”€æ¯ Svelte ç»„ä»¶å®ä¾‹
- [x] Androidï¼šæ³¨å†Œè¿”å›é”®å…³é—­ Modalï¼ˆå·²åœ¨ Modal é»˜è®¤è¡Œä¸ºä¸­æ¶µç›–ï¼‰
- [x] iOSï¼šé€‚é… Safe Areaï¼ˆå·²åœ¨ Svelte ä¸­å®ç°ï¼‰

**4.3 æ¡Œé¢å¸ƒå±€ (`ui/layouts/DesktopLayout.svelte`)**
- [x] å®ç°ä¸‰æ  Tab åˆ‡æ¢ï¼ˆæœç´¢ / å¯¹è¯ / è”æƒ³ï¼‰
- [x] Tab åˆ‡æ¢åŠ¨ç”»ï¼ˆæ¸å˜è¿‡æ¸¡ï¼‰
- [x] è®°ä½ç”¨æˆ·ä¸Šæ¬¡æ¿€æ´»çš„ Tabï¼ˆé€šè¿‡ `BaizeSettings.lastActiveTab`ï¼‰
- [x] é¢æ¿é¡¶éƒ¨æ˜¾ç¤ºç´¢å¼•çŠ¶æ€æŒ‡ç¤ºå™¨ (`StatusBar` ç»„ä»¶å®æ—¶ç›‘å¬ EventBus)

**4.4 ç§»åŠ¨å¸ƒå±€ (`ui/layouts/MobileLayout.svelte`)**
- [x] å®ç°åº•éƒ¨æŠ½å±‰äº¤äº’æ ·å¼ï¼ˆBottom Sheet å¸ƒå±€ä¸å¼¹å‡ºåŠ¨ç”»ï¼‰
- [x] å®ç°åˆ†æ®µæ§ä»¶ (Segmented Control) åˆ‡æ¢æœç´¢/å¯¹è¯/è”æƒ³
- [x] æ‰€æœ‰äº¤äº’å…ƒç´ é”å®šåœ¨å±å¹•ä¸‹åŠéƒ¨ï¼ˆä¾¿äºå•æ‰‹æ“ä½œï¼‰
- [x] iOSï¼šé€‚é… Safe Areaï¼ˆé€‚é… Home Indicator åŒºåŸŸï¼‰
- [x] Androidï¼šé€‚é…ç³»ç»Ÿå¯¼èˆªæ é«˜åº¦ï¼ˆé€šè¿‡å…¨å±€å˜é‡åŒæ­¥ï¼‰

**4.5 æœç´¢ç»„ä»¶ (`ui/components/SearchBar.svelte`)**
- [ ] æœç´¢è¾“å…¥æ¡† + æœç´¢æŒ‰é’®
- [ ] è¾“å…¥é˜²æŠ–ï¼ˆ300ms åè‡ªåŠ¨è§¦å‘æœç´¢ï¼‰
- [ ] æœç´¢ä¸­çŠ¶æ€æ˜¾ç¤ºï¼ˆåŠ è½½åŠ¨ç”»ï¼‰
- [ ] æ¸…ç©ºæŒ‰é’®
- [ ] æœç´¢å†å²è®°å½•ï¼ˆæœ€è¿‘ 10 æ¡ï¼‰

**4.6 æœç´¢ç»“æœå¡ç‰‡ (`ui/components/ResultCard.svelte`)**
- [ ] æ˜¾ç¤ºåŒ¹é…ç‰‡æ®µæ–‡æœ¬ï¼ˆå¸¦å…³é”®è¯é«˜äº®ï¼‰
- [ ] æ˜¾ç¤ºæ¥æºç¬”è®°è·¯å¾„ + æ‰€åœ¨æ ‡é¢˜
- [ ] æ˜¾ç¤ºç›¸ä¼¼åº¦åˆ†æ•°
- [ ] ç‚¹å‡»è·³è½¬åˆ°åŸå§‹ç¬”è®°å¯¹åº”ä½ç½®
- [ ] æ¡Œé¢ç«¯ï¼šæ”¯æŒæ‹–æ‹½å¡ç‰‡å†…å®¹åˆ°ç¼–è¾‘å™¨
- [ ] å¤åˆ¶æŒ‰é’®ï¼šä¸€é”®å¤åˆ¶ç‰‡æ®µå†…å®¹

**4.7 å¯¹è¯é¢æ¿ (`ui/components/ChatPanel.svelte`)**
- [ ] æ¶ˆæ¯åˆ—è¡¨æ¸²æŸ“ï¼ˆç”¨æˆ·æ¶ˆæ¯ + AI å›å¤äº¤æ›¿æ˜¾ç¤ºï¼‰
- [ ] AI å›å¤æµå¼é€å­—æ˜¾ç¤ºï¼ˆæ‰“å­—æœºæ•ˆæœï¼‰
- [ ] AI å›å¤ä¸­çš„å¼•ç”¨é“¾æ¥å¯ç‚¹å‡»è·³è½¬
- [ ] AI å›å¤ä¸­çš„ Markdown æ ¼å¼æ¸²æŸ“ï¼ˆä»£ç å—ã€åˆ—è¡¨ã€ç²—ä½“ç­‰ï¼‰
- [ ] åº•éƒ¨è¾“å…¥æ¡† + å‘é€æŒ‰é’®
- [ ] è¾“å…¥æ¡†æ”¯æŒ `Enter` å‘é€ï¼Œ`Shift+Enter` æ¢è¡Œ
- [ ] å¯¹è¯æ¸…ç©ºæŒ‰é’®ï¼ˆæ–°å»ºå¯¹è¯ï¼‰
- [ ] æ¶ˆæ¯åŠ è½½ä¸­çŠ¶æ€ï¼ˆæ€è€ƒä¸­...ï¼‰
- [ ] åœæ­¢ç”ŸæˆæŒ‰é’®ï¼ˆä¸­æ–­æµå¼å›å¤ï¼‰
- [ ] æ»šåŠ¨è¡Œä¸ºï¼šæ–°æ¶ˆæ¯è‡ªåŠ¨æ»šåˆ°åº•éƒ¨

**4.8 çŸ¥è¯†è”æƒ³é¢æ¿ (`ui/components/InsightPanel.svelte`)**
- [ ] æ˜¾ç¤ºå½“å‰ç¬”è®°çš„ç›¸å…³ç‰‡æ®µæ¨èåˆ—è¡¨
- [ ] æ¯ä¸ªæ¨èé¡¹æ˜¾ç¤ºæ¥æºç¬”è®° + åŒ¹é…ç‰‡æ®µ + åˆ†æ•°
- [ ] ç‚¹å‡»è·³è½¬åˆ°æ¨èç¬”è®°
- [ ] æ— ç»“æœæ—¶æ˜¾ç¤ºç©ºçŠ¶æ€æç¤º
- [ ] ç´¢å¼•æœªå®Œæˆæ—¶æ˜¾ç¤ºå¼•å¯¼æç¤º

**4.9 çŠ¶æ€æŒ‡ç¤ºå™¨ (`ui/components/StatusBar.svelte`)**
- [ ] æ˜¾ç¤ºç´¢å¼•è¿›åº¦ï¼ˆX / Y æ–‡ä»¶å·²ç´¢å¼•ï¼‰
- [ ] æ˜¾ç¤ºæ¨¡å‹åŠ è½½çŠ¶æ€ï¼ˆæœªåŠ è½½ / åŠ è½½ä¸­ / å°±ç»ªï¼‰
- [ ] æ˜¾ç¤ºæ¨¡å‹ä¸‹è½½è¿›åº¦ï¼ˆé¦–æ¬¡ä¸‹è½½æ—¶ï¼‰
- [ ] æ˜¾ç¤ºæ•°æ®åº“ç»Ÿè®¡ï¼ˆæ€»å‘é‡æ•°ã€æ•°æ®åº“å¤§å°ï¼‰
- [ ] ç‚¹å‡»å±•å¼€è¯¦ç»†ä¿¡æ¯é¢æ¿

---

### ç¬¬äº”é˜¶æ®µï¼šè®¾ç½®ä¸é…ç½®

**5.1 è®¾ç½®é¢æ¿ (`settings/settings-tab.ts`)**
- [ ] **æ¨¡å‹è®¾ç½®**ï¼šé€‰æ‹© embedding æ¨¡å‹ï¼ˆé¢„è®¾æ¨¡å‹åˆ—è¡¨ä¸‹æ‹‰æ¡†ï¼‰
- [ ] **æ¨¡å‹è®¾ç½®**ï¼šæ¨¡å‹ç²¾åº¦é€‰æ‹©ï¼ˆè‡ªåŠ¨ / FP16 / Q4ï¼‰
- [ ] **æ¨¡å‹è®¾ç½®**ï¼šæ¨¡å‹ç¼“å­˜ç®¡ç†ï¼ˆæŸ¥çœ‹å¤§å° + æ¸…é™¤ç¼“å­˜æŒ‰é’®ï¼‰
- [ ] **LLM è®¾ç½®**ï¼šLLM æä¾›å•†é€‰æ‹©ï¼ˆDeepSeek / OpenAI / Ollama / è‡ªå®šä¹‰ï¼‰
- [ ] **LLM è®¾ç½®**ï¼šAPI Key è¾“å…¥æ¡†ï¼ˆå¯†ç ç±»å‹ï¼Œä¸æ˜æ–‡æ˜¾ç¤ºï¼‰
- [ ] **LLM è®¾ç½®**ï¼šè‡ªå®šä¹‰ API Base URL è¾“å…¥æ¡†
- [ ] **LLM è®¾ç½®**ï¼šå¯¹è¯æ¨¡å‹é€‰æ‹©ï¼ˆæ¨¡å‹åç§°è¾“å…¥æˆ–ä¸‹æ‹‰ï¼‰
- [ ] **LLM è®¾ç½®**ï¼šè¿æ¥æµ‹è¯•æŒ‰é’®ï¼ˆéªŒè¯ API Key æœ‰æ•ˆæ€§ï¼‰
- [ ] **ç´¢å¼•è®¾ç½®**ï¼šæ’é™¤ç›®å½•/æ–‡ä»¶åˆ—è¡¨ï¼ˆæ”¯æŒ glob æ¨¡å¼ï¼‰
- [ ] **ç´¢å¼•è®¾ç½®**ï¼šåˆ†å—ç­–ç•¥é€‰æ‹©ï¼ˆæ ‡é¢˜åˆ†å‰² / å›ºå®šé•¿åº¦ / è¯­ä¹‰æ®µè½ï¼‰
- [ ] **ç´¢å¼•è®¾ç½®**ï¼šåˆ†å—å¤§å°è®¾ç½®ï¼ˆæœ€å¤§ tokens æ•°ï¼‰
- [ ] **ç´¢å¼•è®¾ç½®**ï¼šç§»åŠ¨ç«¯ç´¢å¼•è§¦å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨ / ä»…å……ç”µæ—¶ / æ‰‹åŠ¨ï¼‰
- [ ] **ç´¢å¼•è®¾ç½®**ï¼šæ‰‹åŠ¨è§¦å‘å…¨é‡é‡å»ºç´¢å¼•æŒ‰é’®
- [ ] **æœç´¢è®¾ç½®**ï¼šé»˜è®¤è¿”å›ç»“æœæ•° (Top-K)
- [ ] **æœç´¢è®¾ç½®**ï¼šæœ€ä½ç›¸ä¼¼åº¦é˜ˆå€¼
- [ ] **é«˜çº§è®¾ç½®**ï¼šWorker çº¿ç¨‹æ•°ï¼ˆæ¡Œé¢ç«¯ï¼Œé»˜è®¤è‡ªåŠ¨ï¼‰
- [ ] **é«˜çº§è®¾ç½®**ï¼šæ—¥å¿—çº§åˆ«ï¼ˆdebug / info / warn / errorï¼‰
- [ ] **å…³äº**ï¼šæ’ä»¶ç‰ˆæœ¬ã€æ•°æ®åº“ç»Ÿè®¡ã€ä½œè€…ä¿¡æ¯

**5.2 é»˜è®¤é…ç½® (`settings/default-settings.ts`)**
- [ ] å®šä¹‰ `BaizeSettings` ç±»å‹æ¥å£
- [ ] å®šä¹‰æ‰€æœ‰è®¾ç½®é¡¹çš„é»˜è®¤å€¼
- [ ] å®ç°è®¾ç½®å€¼æ ¡éªŒå‡½æ•°ï¼ˆç±»å‹æ£€æŸ¥ã€èŒƒå›´é™åˆ¶ï¼‰

---

### ç¬¬å…­é˜¶æ®µï¼šæ ·å¼ä¸è§†è§‰ (`styles/`)

- [ ] `variables.css`ï¼šå®šä¹‰è‰²å½©ä½“ç³» CSS å˜é‡ï¼ˆäº®è‰²/æš—è‰²ä¸»é¢˜åŒå¥—ï¼‰
- [ ] `variables.css`ï¼šå®šä¹‰å­—ä½“ã€å­—å·ã€é—´è·ã€åœ†è§’ã€é˜´å½± CSS å˜é‡
- [ ] `base.css`ï¼šåŸºç¡€é‡ç½®æ ·å¼ + æ»šåŠ¨æ¡è‡ªå®šä¹‰
- [ ] `components.css`ï¼šSearchBar ç»„ä»¶æ ·å¼
- [ ] `components.css`ï¼šResultCard å¡ç‰‡æ ·å¼ï¼ˆæ‚¬åœæ•ˆæœã€åˆ†æ•°æ ‡ç­¾ï¼‰
- [ ] `components.css`ï¼šChatPanel å¯¹è¯æ°”æ³¡æ ·å¼ï¼ˆç”¨æˆ·/AI å·®å¼‚åŒ–é…è‰²ï¼‰
- [ ] `components.css`ï¼šInsightPanel æ¨èé¡¹æ ·å¼
- [ ] `components.css`ï¼šStatusBar è¿›åº¦æ¡ + çŠ¶æ€æ ‡ç­¾æ ·å¼
- [ ] `components.css`ï¼šTab åˆ‡æ¢ / Segmented Control æ ·å¼
- [ ] `desktop.css`ï¼šä¾§è¾¹é¢æ¿éª¨æ¶å¸ƒå±€
- [ ] `desktop.css`ï¼šæ‹–æ‹½äº¤äº’è§†è§‰åé¦ˆï¼ˆæ‹–æ‹½ä¸­çš„åŠé€æ˜å‰¯æœ¬ï¼‰
- [ ] `mobile.css`ï¼šBottom Sheet æ»‘åŠ¨åŠ¨ç”»
- [ ] `mobile.css`ï¼šå•æ‰‹æ“ä½œçƒ­åŒºé«˜äº®
- [ ] `mobile.css`ï¼šiOS Safe Area padding
- [ ] `mobile.css`ï¼šAndroid å¯¼èˆªæ é€‚é…
- [ ] éªŒè¯ Obsidian é»˜è®¤ä¸»é¢˜ï¼ˆäº®è‰² + æš—è‰²ï¼‰ä¸‹çš„è§†è§‰ä¸€è‡´æ€§
- [ ] éªŒè¯ä¸»æµç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼ˆMinimalã€Thingsã€Blue Topazï¼‰çš„å…¼å®¹æ€§

---

### ç¬¬ä¸ƒé˜¶æ®µï¼šæµ‹è¯•ä¸è´¨é‡ä¿è¯

- [ ] å•å…ƒæµ‹è¯•ï¼š`markdown-chunker.ts` å„ç§åˆ†å—ç­–ç•¥
- [ ] å•å…ƒæµ‹è¯•ï¼š`event-bus.ts` äº‹ä»¶è®¢é˜…/å‘å°„/å–æ¶ˆ
- [ ] å•å…ƒæµ‹è¯•ï¼š`vault-storage.ts` è·¯å¾„æ‹¼æ¥ä¸é”™è¯¯å¤„ç†
- [ ] å•å…ƒæµ‹è¯•ï¼š`rag-pipeline.ts` Prompt æ‹¼æ¥é€»è¾‘
- [ ] é›†æˆæµ‹è¯•ï¼šWorker é€šä¿¡ï¼ˆä¸»çº¿ç¨‹ â†” Worker æ¶ˆæ¯æ”¶å‘ï¼‰
- [ ] é›†æˆæµ‹è¯•ï¼šå®Œæ•´ç´¢å¼•æµç¨‹ï¼ˆæ–‡ä»¶å˜æ›´ â†’ åˆ†å— â†’ å‘é‡åŒ– â†’ å­˜å‚¨ï¼‰
- [ ] é›†æˆæµ‹è¯•ï¼šå®Œæ•´æœç´¢æµç¨‹ï¼ˆæŸ¥è¯¢ â†’ å‘é‡åŒ– â†’ ANN æœç´¢ â†’ è¿”å›ç»“æœï¼‰
- [ ] æ€§èƒ½æµ‹è¯•ï¼š1000 ç¯‡ç¬”è®°å…¨é‡ç´¢å¼•è€—æ—¶åŸºå‡†
- [ ] æ€§èƒ½æµ‹è¯•ï¼š10000 æ¡å‘é‡ Top-10 æœç´¢å»¶è¿ŸåŸºå‡†
- [ ] æ€§èƒ½æµ‹è¯•ï¼šç§»åŠ¨ç«¯ (Android/iOS) å†…å­˜å ç”¨ç›‘æ§
- [ ] è¾¹ç•Œæµ‹è¯•ï¼šç©º Vaultï¼ˆé›¶æ–‡ä»¶ï¼‰çŠ¶æ€å¤„ç†
- [ ] è¾¹ç•Œæµ‹è¯•ï¼šè¶…å¤§æ–‡ä»¶ï¼ˆ> 100KB å•æ–‡ä»¶ï¼‰åˆ†å—éªŒè¯
- [ ] è¾¹ç•Œæµ‹è¯•ï¼šç½‘ç»œæ–­å¼€æ—¶ LLM è°ƒç”¨é”™è¯¯æ¢å¤
- [ ] è¾¹ç•Œæµ‹è¯•ï¼šæ¨¡å‹ä¸‹è½½ä¸­æ–­åçš„æ–­ç‚¹ç»­ä¼  / é‡è¯•

---

### ç¬¬å…«é˜¶æ®µï¼šå‘å¸ƒä¸è¿è¥

- [ ] ç¼–å†™å®Œæ•´ READMEï¼ˆåŠŸèƒ½æˆªå›¾ã€å®‰è£…æ­¥éª¤ã€ä½¿ç”¨æŒ‡å—ã€é…ç½®è¯´æ˜ï¼‰
- [ ] å½•åˆ¶åŠŸèƒ½æ¼”ç¤º GIF / è§†é¢‘
- [ ] ç¼–å†™ CHANGELOG.md
- [ ] ç¼–å†™ LICENSEï¼ˆMITï¼‰
- [ ] é…ç½® GitHub Actions CIï¼ˆè‡ªåŠ¨æ„å»º + å‘å¸ƒ Releaseï¼‰
- [ ] æ„å»ºç”Ÿäº§åŒ…éªŒè¯ï¼ˆ`main.js` ä½“ç§¯ã€WASM æ–‡ä»¶å®Œæ•´æ€§ï¼‰
- [ ] æäº¤ Obsidian ç¤¾åŒºæ’ä»¶ä»“åº“ PRï¼ˆ`obsidian-releases`ï¼‰
- [ ] ç¤¾åŒºæ’ä»¶å®¡æ ¸åé¦ˆä¿®å¤
- [ ] é¦–ç‰ˆå‘å¸ƒ (v0.1.0)
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆæ¸ é“æ­å»ºï¼ˆGitHub Issues æ¨¡æ¿ï¼‰

---

*"çŸ¥ä¸‡ç‰©ä¹‹æƒ…ï¼Œé€šå¤©ä¸‹ä¹‹ç†ã€‚"*